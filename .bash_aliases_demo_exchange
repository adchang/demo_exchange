export ORDER_SERVICE_VERSION='0.0.1a'

demo-exchange-order-up() {
  demo-exchange-order-build;
  demo-exchange-order-run;
}
demo-exchange-order-build() {
  docker rm -f demo_exchange.order_service-$ORDER_SERVICE_VERSION;
  docker image rm demo_exchange.order_service:$ORDER_SERVICE_VERSION;
  docker build -f src/DemoExchange.OrderService/Dockerfile --tag demo_exchange.order_service:$ORDER_SERVICE_VERSION .
  docker rmi $(docker images -f 'dangling=true' -q)
}
demo-exchange-order-run() {
  docker run -v /opt/adchang/_log/demo_exchange:/log --publish 8080:80 --detach --name demo_exchange.order_service-$ORDER_SERVICE_VERSION demo_exchange.order_service:$ORDER_SERVICE_VERSION
}
demo-exchange-order-start() {
  docker-start demo_exchange.order_service-$ORDER_SERVICE_VERSION
}
demo-exchange-order-stop() {
  docker-stop demo_exchange.order_service-$ORDER_SERVICE_VERSION
}

demo-exchange-orderGrpc-up() {
  demo-exchange-orderGrpc-build;
  demo-exchange-orderGrpc-run;
}
demo-exchange-orderGrpc-build() {
  docker rm -f demo_exchange.order_service_grpc-$ORDER_SERVICE_VERSION;
  docker image rm demo_exchange.order_service_grpc:$ORDER_SERVICE_VERSION;
  docker build -f src/DemoExchange.OrderServiceGrpc/Dockerfile --tag demo_exchange.order_service_grpc:$ORDER_SERVICE_VERSION .
  docker rmi $(docker images -f 'dangling=true' -q)
}
demo-exchange-orderGrpc-run() {
  docker run --detach -p 8091:443 -e ASPNETCORE_URLS="https://+;http://+" -e ASPNETCORE_HTTPS_PORT=8091 -e ASPNETCORE_Kestrel__Certificates__Default__Password="PASSWORD" -e ASPNETCORE_Kestrel__Certificates__Default__Path=/https/DemoExchange.OrderServiceGrpc.pfx -v /opt/adchang/htdocs/demo_exchange/docker:/https/ -v /opt/adchang/_log/demo_exchange:/log --name demo_exchange.order_service_grpc-$ORDER_SERVICE_VERSION demo_exchange.order_service_grpc:$ORDER_SERVICE_VERSION
}
demo-exchange-orderGrpc-start() {
  docker-start demo_exchange.order_service_grpc-$ORDER_SERVICE_VERSION
}
demo-exchange-orderGrpc-stop() {
  docker-stop demo_exchange.order_service_grpc-$ORDER_SERVICE_VERSION
}
